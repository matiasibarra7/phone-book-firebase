(this["webpackJsonpfirebase-storage-test"]=this["webpackJsonpfirebase-storage-test"]||[]).push([[0],{43:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a.n(n),r=a(28),s=a.n(r),l=a(6),i=a.n(l),o=a(18),u=a(11),j=a(4),b=a(16),d=a(7),m=a(21);a(44),a(36),a(45);m.a.initializeApp({apiKey:"AIzaSyBTbPzUKMEJwgrXVWvFQyDFhThMbgX5cbs",authDomain:"udemy-auth-learning.firebaseapp.com",projectId:"udemy-auth-learning",storageBucket:"udemy-auth-learning.appspot.com",messagingSenderId:"409133570692",appId:"1:409133570692:web:9958d4098531ba38ac80d1",measurementId:"G-3WJTJZHHP4"});var h=m.a.firestore(),p=m.a.auth(),O=m.a.storage(),x=a(1),f="P5N8GPwMlwbegabdHgewSN0q0YO2";var v=function(e){var t=Object(n.useState)(""),a=Object(j.a)(t,2),c=a[0],r=a[1],s=Object(n.useState)(""),l=Object(j.a)(s,2),b=l[0],d=l[1],m=Object(n.useState)([]),p=Object(j.a)(m,2),O=p[0],v=p[1],g=Object(n.useState)(null),N=Object(j.a)(g,2),k=N[0],y=N[1],w=Object(n.useState)(!1),U=Object(j.a)(w,2),F=U[0],S=U[1],I=Object(n.useState)(null),D=Object(j.a)(I,2),P=D[0],C=D[1],T=Object(n.useState)(!1),E=Object(j.a)(T,2),M=E[0],B=E[1],L=Object(n.useState)(!1),W=Object(j.a)(L,2),A=W[0],H=W[1];Object(n.useEffect)((function(){(function(){var t=Object(u.a)(i.a.mark((function t(){var a,n,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(H(!0),t.prev=1,!e.currentUser){t.next=10;break}return t.next=5,h.collection("phoneBook-".concat(e.currentUser)).get();case 5:a=t.sent,n=a.docs,c=n.map((function(e){return Object(o.a)({id:e.id},e.data())})),v(c),H(!1);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}})()()}),[e.currentUser]);var G=function(){var t=Object(u.a)(i.a.mark((function t(){var a,n,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(H(!0),t.prev=1,!e.currentUser){t.next=10;break}return t.next=5,h.collection("phoneBook-".concat(e.currentUser)).get();case 5:a=t.sent,n=a.docs,c=n.map((function(e){return Object(o.a)({id:e.id},e.data())})),v(c),H(!1);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}(),J=function(){var t=Object(u.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.currentUser!==f){t.next=5;break}e.denyFeature(a),t.next=30;break;case 5:if(c.trim()){t.next=9;break}y("Name can't be blanck"),t.next=30;break;case 9:if(b){t.next=13;break}y("Phone can't be blanck"),t.next=30;break;case 13:return y(null),B(!0),n={name:c,phone:b},t.prev=16,t.next=19,h.collection("phoneBook-".concat(e.currentUser)).add(n);case 19:r(""),d(""),S(!0),G(),B(!1),setTimeout((function(){S(!1)}),3e3),t.next=30;break;case 27:t.prev=27,t.t0=t.catch(16),console.log(t.t0);case 30:case"end":return t.stop()}}),t,null,[[16,27]])})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=Object(u.a)(i.a.mark((function t(a){var n,c,s,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.collection("phoneBook-".concat(e.currentUser)).doc(a).get();case 3:n=t.sent,c=n.data(),s=c.name,l=c.phone,d(l),r(s),C(a),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),R=function(){var t=Object(u.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),B(!0),n={name:c,phone:b},t.prev=3,t.next=6,h.collection("phoneBook-".concat(e.currentUser)).doc(P).set(n);case 6:C(null),d(""),r(""),G(),B(!1),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[3,13]])})));return function(e){return t.apply(this,arguments)}}(),q=function(){var t=Object(u.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.collection("phoneBook-".concat(e.currentUser)).doc(a).delete();case 3:G(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"container mt-5",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("h2",{children:"New contact"}),Object(x.jsxs)("form",{className:"form-group",onSubmit:P?R:J,children:[Object(x.jsx)("input",{type:"text",value:c,onChange:function(e){return r(e.target.value)},className:"form-control",placeholder:"Type a name"}),Object(x.jsx)("input",{type:"number",value:b,onChange:function(e){return d(e.target.value)},className:"form-control",placeholder:"Type a number phone"}),Object(x.jsx)("div",{className:"d-grid gap-2",children:P?Object(x.jsx)(x.Fragment,{children:M?Object(x.jsx)("div",{className:"btn btn-dark btn-block mt-3",children:Object(x.jsx)("div",{className:"spinner-border text-light",role:"status",children:Object(x.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):Object(x.jsx)("input",{type:"submit",value:"Update contact",className:"btn btn-primary btn-block mt-3"})}):Object(x.jsx)(x.Fragment,{children:M?Object(x.jsx)("div",{className:"btn btn-dark btn-block mt-3",children:Object(x.jsx)("div",{className:"spinner-border text-light",role:"status",children:Object(x.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):Object(x.jsx)("input",{type:"submit",value:"Add contact",className:"btn btn-dark btn-block mt-3"})})})]}),k?Object(x.jsx)("div",{className:"text-danger mt-2",children:k}):Object(x.jsx)(x.Fragment,{}),F?Object(x.jsx)("div",{className:"text-success mt-2",children:"Person correctly added!"}):Object(x.jsx)(x.Fragment,{})]}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("h2",{children:"Contact list"}),Object(x.jsx)("ul",{className:"list-group",children:A?Object(x.jsx)("li",{className:"list-group-item text-center",children:Object(x.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(x.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):Object(x.jsx)(x.Fragment,{children:O.length?O.map((function(t,a){return Object(x.jsx)("li",{className:"list-group-item",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col",children:t.name}),Object(x.jsx)("div",{className:"col",children:t.phone}),Object(x.jsxs)("div",{className:"col btn-group float-end",children:[" ",Object(x.jsx)("button",{className:"btn btn-secondary",onClick:e.currentUser===f?e.denyFeature:function(){return z(t.id)},children:"Update"}),Object(x.jsx)("button",{className:"btn btn-danger",onClick:e.currentUser===f?e.denyFeature:function(){return q(t.id)},children:"Delete"})]})]})},t.id+a)})):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{children:"It seems that there are no people here..."}),Object(x.jsx)("div",{children:"Try adding a new contact!"})]})})})]})]})})};var g=function(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("h1",{className:"text-center mt-2",children:"Home"})})};var N=function(e){var t=Object(d.f)();return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("nav",{className:"navbar navbar-dark bg-dark navbar-expand-lg",children:Object(x.jsxs)("div",{className:"container-fluid",children:[Object(x.jsx)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:e.currentUser?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(b.b,{className:"nav-link",to:"/",children:"Home"})}),"noOne"!==e.currentUser?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(b.b,{className:"nav-link",to:"/phone-book",children:"Phone-book"})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(b.b,{className:"nav-link",to:"/profile",children:"Profile"})})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(b.b,{className:"nav-link",to:"/register",children:"Register"})}),Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)(b.b,{className:"nav-link",to:"/login",children:"Login"})})]})]}):Object(x.jsx)(x.Fragment,{})}),Object(x.jsx)(x.Fragment,{}),e.currentUser?Object(x.jsx)(x.Fragment,{children:"noOne"!==e.currentUser?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("span",{style:{color:"wheat"},className:"me-2",children:e.userData?e.userData.nick:""}),Object(x.jsx)("button",{className:"btn btn-danger",onClick:function(){p.signOut().then((function(e){t.push("/")})).catch((function(e){console.log(e)}))},children:"Logout"})]}):Object(x.jsx)(x.Fragment,{})}):Object(x.jsx)(x.Fragment,{})]})})})};var k=function(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(""),s=Object(j.a)(r,2),l=s[0],i=s[1],o=Object(n.useState)(null),u=Object(j.a)(o,2),m=u[0],h=u[1],O=Object(d.f)();return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("form",{className:"container-fluid border mt-5",style:{maxWidth:"360px"},onSubmit:function(e){e.preventDefault(),p.signInWithEmailAndPassword(a,l).then((function(e){h(null),O.push("/")})).catch((function(e){h(e.message)}))},children:[Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"emailInput",className:"form-label",children:"Email"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"emailInput",placeholder:"Type a email for username",onChange:function(e){return c(e.target.value)}})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"passInput",className:"form-label",children:"Password"}),Object(x.jsx)("input",{type:"password",className:"form-control",id:"passInput",placeholder:"Type a password",onChange:function(e){return i(e.target.value)}})]}),Object(x.jsx)("div",{className:"mb-3",children:Object(x.jsx)("input",{type:"submit",className:"btn btn-dark btn-block mt-4 w-100",value:"Log In"})}),m?Object(x.jsx)("div",{className:"text-danger mb-2",children:m}):Object(x.jsx)(x.Fragment,{}),Object(x.jsxs)("div",{className:"mb-2",children:["Don't have an account? ",Object(x.jsx)(b.b,{to:"/register",children:"Sign up"})," "]})]})})};var y=function(e){var t=Object(n.useState)(""),a=Object(j.a)(t,2),c=a[0],r=a[1],s=Object(n.useState)(""),l=Object(j.a)(s,2),i=l[0],o=l[1],u=Object(n.useState)(null),b=Object(j.a)(u,2),m=b[0],h=b[1],O=Object(d.f)();return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("form",{className:"container-fluid border mt-5",style:{maxWidth:"360px"},onSubmit:function(t){t.preventDefault(),p.createUserWithEmailAndPassword(c,i).then((function(t){e.showMessage("Great! Now you can use your own Phone book and personalize your profile!"),h(null),O.push("/")})).catch((function(e){h(e.message)}))},children:[Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"emailInput",className:"form-label",children:"Email"}),Object(x.jsx)("input",{type:"email",className:"form-control",id:"emailInput",placeholder:"Type a email for username",onChange:function(e){return r(e.target.value)}})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"passInput",className:"form-label",children:"Password"}),Object(x.jsx)("input",{type:"password",className:"form-control",id:"passInput",placeholder:"Type a password",onChange:function(e){return o(e.target.value)}})]}),Object(x.jsx)("div",{className:"mb-3",children:Object(x.jsx)("input",{type:"submit",className:"btn btn-dark btn-block mt-4 w-100",value:"Sign up"})}),m?Object(x.jsx)("div",{className:"text-danger mb-2",children:m}):Object(x.jsx)(x.Fragment,{})]})})};var w=function(e){var t=Object(n.useState)(""),a=Object(j.a)(t,2),c=a[0],r=a[1],s=Object(n.useState)(""),l=Object(j.a)(s,2),b=l[0],d=l[1],m=Object(n.useState)(""),p=Object(j.a)(m,2),f=p[0],v=p[1],g=Object(n.useState)(e.currentUserData),N=Object(j.a)(g,2),k=N[0],y=N[1],w=Object(n.useState)(null),U=Object(j.a)(w,2),F=U[0],S=U[1],I=Object(n.useState)(!0),D=Object(j.a)(I,2),P=D[0],C=D[1];Object(n.useEffect)((function(){C(!0);var t=function(){var t=Object(u.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.currentUserId){t.next=7;break}return t.next=4,O.ref("/images/".concat(e.currentUserId)).getDownloadURL();case 4:a=t.sent,S(a),C(!1);case 7:t.next=14;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0),S(null),C(!1);case 14:console.log("Efecto!");case 15:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}();y(e.currentUserData),t()}),[e.currentUserId,e.currentUserData]);var T=function(){var t=Object(u.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("out the useEffect"),t.prev=1,!e.currentUserId){t.next=7;break}return t.next=5,O.ref("/images/".concat(e.currentUserId)).getDownloadURL();case 5:a=t.sent,S(a);case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0),S(null);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}(),E=function(){var t=Object(u.a)(i.a.mark((function t(){var a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.currentUserId){t.next=14;break}return t.prev=1,t.next=4,h.collection("Users-Data").doc(e.currentUserId).get();case 4:a=t.sent,y(a.data()),n=Object(o.a)(Object(o.a)({},a.data()),{},{id:e.currentUserId}),e.setCurrentUserData(n),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.log(t.t0);case 13:console.log("Efecto!");case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(){return t.apply(this,arguments)}}(),M=function(){var t=Object(u.a)(i.a.mark((function t(a){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),C(!0),n={nick:c,gender:b},t.prev=3,t.next=6,h.collection("Users-Data").doc(e.currentUserId).set(n);case 6:if(console.log("fin de carga de data"),!f){t.next=13;break}return t.next=10,O.ref("/images/".concat(e.currentUserId)).put(f);case 10:return t.next=12,T();case 12:console.log("fin de carga de img");case 13:return t.next=15,E();case 15:C(!1),console.log("fin de get img"),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(3),console.log(a);case 22:case"end":return t.stop()}}),t,null,[[3,19]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsxs)("div",{className:"container",children:[Object(x.jsx)("h1",{className:"text-center mt-2",children:"Profile"}),Object(x.jsxs)("div",{className:"row mt-5",children:[Object(x.jsx)("div",{className:"col",children:P?Object(x.jsx)("div",{className:"text-center",children:Object(x.jsx)("div",{className:"spinner-border text-primary",role:"status",children:Object(x.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("div",{className:"d-flex justify-content-center",children:Object(x.jsxs)("div",{className:"card",style:{width:"18rem"},children:[F?Object(x.jsx)("img",{src:F,className:"card-img-top",alt:"..."}):Object(x.jsx)("img",{src:"/phone-book-firebase/images/unnamed.jpg",className:"card-img-top",alt:"..."}),k?Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title",children:k.nick}),Object(x.jsx)("p",{className:"card-text",children:k.gender})]}):Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{className:"card-title",children:"Unknown"}),Object(x.jsx)("p",{className:"card-text",children:"No data"})]})]})})})}),Object(x.jsx)("div",{className:"col",children:Object(x.jsxs)("form",{onSubmit:"P5N8GPwMlwbegabdHgewSN0q0YO2"===e.currentUserId?e.denyFeature:M,className:"form-control",style:{maxWidth:"480px"},children:[Object(x.jsx)("h4",{children:"Edit Profile"}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"username",className:"form-label",children:"Name"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"Type a name or nickname",onChange:function(e){r(e.target.value)}})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{className:"form-label",children:"Gender"}),Object(x.jsxs)("select",{className:"form-select","aria-label":"Default select example",onChange:function(e){d(e.target.value)},children:[Object(x.jsx)("option",{defaultValue:!0,children:"Open this select menu"}),Object(x.jsx)("option",{value:"Male",children:"Male"}),Object(x.jsx)("option",{value:"Female",children:"Female"}),Object(x.jsx)("option",{value:"Unicorn",children:"Unicorn \ud83e\udd84"})]})]}),Object(x.jsxs)("div",{className:"mb-3",children:[Object(x.jsx)("label",{htmlFor:"imageInput",className:"form-label",children:"Name"}),Object(x.jsx)("input",{type:"file",className:"form-control",id:"imageInput",placeholder:"Type a name or nickname",onChange:function(e){return v(e.target.files[0])}})]}),Object(x.jsx)("input",{type:"submit",className:"btn btn-dark mt-4 w-100",value:"Update profile"})]})})]})]})};var U=function(){var e=Object(n.useState)(null),t=Object(j.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)(null),s=Object(j.a)(r,2),l=s[0],m=s[1],O=Object(n.useState)(null),f=Object(j.a)(O,2),U=f[0],F=f[1];Object(n.useEffect)((function(){var e=function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.collection("Users-Data").doc(t).get();case 3:a=e.sent,m(Object(o.a)(Object(o.a)({},a.data()),{},{id:t})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();p.onAuthStateChanged((function(t){t?(c(t.uid),e(t.uid)):(c("noOne"),m(null))}))}),[]);var S=function(e){e.preventDefault(),I("deny")},I=function(e){"deny"===e?(F("This operation is reserved for register users only. If you wanna try it, please, register with a email (Not necessary a real one) and try again"),setTimeout((function(){F(null)}),1e4)):(F(e),setTimeout((function(){F(null)}),4e3))};return Object(x.jsxs)(b.a,{basename:"/",children:[Object(x.jsx)(N,{currentUser:a,userData:l}),U?Object(x.jsx)("div",{className:"alert alert-success",role:"alert",children:U}):Object(x.jsx)(x.Fragment,{}),Object(x.jsxs)(d.c,{children:[Object(x.jsx)(d.a,{exact:!0,path:"/",children:Object(x.jsx)(g,{msg:U,showMessage:I})}),Object(x.jsx)(d.a,{path:"/login",children:Object(x.jsx)(k,{})}),Object(x.jsx)(d.a,{path:"/register",children:Object(x.jsx)(y,{showMessage:I})}),Object(x.jsx)(d.a,{path:"/phone-book",children:Object(x.jsx)(v,{currentUser:a,denyFeature:S})}),Object(x.jsx)(d.a,{path:"/profile",children:Object(x.jsx)(w,{currentUserId:a,setCurrentUserData:m,currentUserData:l,denyFeature:S})})]})]})};s.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(U,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.3355bd0a.chunk.js.map